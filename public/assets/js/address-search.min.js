var AddressOpts={url:"https://www.bathnes.gov.uk/webapi/api/AddressesAPI/v2/search/",resultSize:50,minChars:3,useCache:"true",successCallback:buildAddressSelect};function addressSearch(){var s=$("#address").val(),e=s.toUpperCase().replace(/[^\w\s]|_/g,"").trim();s.length>=AddressOpts.minChars?$.ajax({type:"GET",url:AddressOpts.url+e+"/"+AddressOpts.resultSize+"/"+AddressOpts.useCache,contentType:"application/json; charset=utf-8",dataType:"json",success:function(s,e,d){if(void 0!==s){var t=[];$.each(s,function(s,e){e.full_Address=e.full_Address.toUpperCase(),e.payment_Address=e.payment_Address.toUpperCase(),t.push({id:e.uprn+"_"+e.easting+"_"+e.northing+"_"+e.full_Address+"_"+e.payment_Address+"_"+e.ward,address:e.full_Address,search:e.full_Address})}),AddressOpts.successCallback&&AddressOpts.successCallback(t)}}}):clearAddressSelect()}function buildAddressSelect(s){clearAddressSelect();var e=$("select#address-select");e.append($("<option />").val("").text("Please select")),$.each(s,function(){e.append($("<option />").val(this.id.split("_")[4]).text(this.address))})}function clearAddressSelect(){$("select#address-select").empty(),$("#address-result").text("")}$(document).ready(function(){$("#address").on("keyup search",function(){addressSearch()}),$("select#address-select").on("change",function(){var s="",e=$(this).val();if(""!=e){for(var d=e.split("|"),t=[],r=0;r<d.length;r++)""!=d[r]&&(t[t.length]=d[r]);s=t.join(",<br>")}$("#address-result").html(s)})});